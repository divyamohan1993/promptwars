/* ============================================================
   QuestForge: The Upside Down — Animation Keyframes
   All animations respect prefers-reduced-motion.
   ============================================================ */

@media (prefers-reduced-motion: no-preference) {

  /* Title flicker — Stranger Things neon sign effect */
  @keyframes flicker {
    0%, 100% { opacity: 1; }
    4% { opacity: 0.9; }
    6% { opacity: 0.85; }
    8% { opacity: 0.95; }
    40% { opacity: 1; }
    42% { opacity: 0.6; }
    43% { opacity: 0.85; }
    44% { opacity: 0.9; }
    45% { opacity: 1; }
    76% { opacity: 1; }
    77% { opacity: 0.4; }
    78% { opacity: 0.8; }
    80% { opacity: 1; }
  }

  .flickering-title {
    animation: flicker 3s infinite;
  }

  /* Christmas lights glow cycle */
  @keyframes christmasGlow {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
  }

  .light {
    animation: christmasGlow 2s infinite ease-in-out;
  }
  .light:nth-child(2n) { animation-delay: 0.3s; }
  .light:nth-child(3n) { animation-delay: 0.6s; }
  .light:nth-child(4n) { animation-delay: 0.9s; }
  .light:nth-child(5n) { animation-delay: 1.2s; }

  /* Loading spinner pulse */
  @keyframes loadingPulse {
    0%, 100% { opacity: 0.3; transform: scale(0.8); }
    50% { opacity: 1; transform: scale(1.3); }
  }

  .loading-light {
    animation: loadingPulse 1.4s infinite ease-in-out;
  }
  .loading-light:nth-child(1) { animation-delay: 0s; }
  .loading-light:nth-child(2) { animation-delay: 0.15s; }
  .loading-light:nth-child(3) { animation-delay: 0.3s; }
  .loading-light:nth-child(4) { animation-delay: 0.45s; }
  .loading-light:nth-child(5) { animation-delay: 0.6s; }

  /* Fade + slide in for screens */
  @keyframes fadeSlideIn {
    from { opacity: 0; transform: translateY(1rem); }
    to { opacity: 1; transform: translateY(0); }
  }

  .screen--active {
    animation: fadeSlideIn 0.4s ease-out;
  }

  /* Heart beat on damage */
  @keyframes heartBeat {
    0% { transform: scale(1); }
    25% { transform: scale(1.3); }
    50% { transform: scale(0.9); }
    100% { transform: scale(1); }
  }

  .heart--damaged {
    animation: heartBeat 0.4s ease-out;
  }

  /* Item bounce in for inventory */
  @keyframes itemBounceIn {
    0% { opacity: 0; transform: scale(0) rotate(-15deg); }
    60% { transform: scale(1.15) rotate(3deg); }
    100% { opacity: 1; transform: scale(1) rotate(0deg); }
  }

  .inventory-item--new {
    animation: itemBounceIn 0.5s ease-out;
  }

  /* Item found overlay slide up */
  @keyframes itemFoundSlide {
    0% { opacity: 0; transform: translate(-50%, 2rem); }
    20% { opacity: 1; transform: translate(-50%, 0); }
    80% { opacity: 1; transform: translate(-50%, 0); }
    100% { opacity: 0; transform: translate(-50%, -1rem); }
  }

  .item-found-overlay:not([hidden]) {
    animation: itemFoundSlide 2s ease-out forwards;
  }

  /* Sparkle rotation for item found */
  @keyframes sparkleRotate {
    0% { transform: rotate(0deg) scale(0.5); opacity: 0; }
    50% { transform: rotate(180deg) scale(1.2); opacity: 1; }
    100% { transform: rotate(360deg) scale(1); opacity: 1; }
  }

  .item-found-sparkle {
    animation: sparkleRotate 0.6s ease-out;
  }

  /* Achievement toast slide from top-right */
  @keyframes achievementSlide {
    0% { opacity: 0; transform: translateX(100%); }
    15% { opacity: 1; transform: translateX(0); }
    85% { opacity: 1; transform: translateX(0); }
    100% { opacity: 0; transform: translateX(100%); }
  }

  .achievement-popup:not([hidden]) {
    animation: achievementSlide 3s ease-out forwards;
  }

  /* Encounter card appear */
  @keyframes encounterAppear {
    0% { opacity: 0; transform: scale(0.5) rotate(-5deg); }
    70% { transform: scale(1.05) rotate(1deg); }
    100% { opacity: 1; transform: scale(1) rotate(0deg); }
  }

  .encounter-overlay:not([hidden]) .encounter-card {
    animation: encounterAppear 0.5s ease-out;
  }

  /* Blink animation for status indicators */
  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  /* Screen shake on damage */
  @keyframes screenShake {
    0%, 100% { transform: translateX(0); }
    10% { transform: translateX(-4px); }
    20% { transform: translateX(4px); }
    30% { transform: translateX(-3px); }
    40% { transform: translateX(3px); }
    50% { transform: translateX(-2px); }
    60% { transform: translateX(2px); }
    70% { transform: translateX(-1px); }
    80% { transform: translateX(1px); }
  }

  .screen-shake {
    animation: screenShake 0.4s ease-out;
  }

  /* Map node ping for new location */
  @keyframes mapNodePing {
    0% { box-shadow: 0 0 0 0 rgba(204, 34, 0, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(204, 34, 0, 0); }
    100% { box-shadow: 0 0 0 0 rgba(204, 34, 0, 0); }
  }

  /* Neon pulse for interactive elements */
  @keyframes neonPulse {
    0%, 100% { box-shadow: 0 0 5px currentColor; }
    50% { box-shadow: 0 0 15px currentColor, 0 0 30px currentColor; }
  }

  /* Floating particles for Upside Down effect */
  @keyframes particleFloat {
    0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
    10% { opacity: 0.6; }
    90% { opacity: 0.6; }
    100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
  }

  .particle-overlay .particle {
    animation: particleFloat linear infinite;
  }

  /* Celebration burst for victory */
  @keyframes celebrationBurst {
    0% { transform: scale(0); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.7; }
    100% { transform: scale(2); opacity: 0; }
  }

  /* Choice button hover neon effect */
  @keyframes choiceGlow {
    0%, 100% { box-shadow: 0 0 4px var(--accent, #cc2200); }
    50% { box-shadow: 0 0 12px var(--accent, #cc2200), 0 0 20px var(--accent, #cc2200); }
  }

  .choice-btn:hover,
  .choice-btn:focus-visible {
    animation: choiceGlow 1.5s infinite;
  }
}

/* Reduced motion: disable all animations */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
